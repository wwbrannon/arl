;; Native tests for math operations - User-facing examples
;; For comprehensive edge case testing, see tests/testthat/test-stdlib-math.R
;; These tests demonstrate idiomatic usage patterns with simple examples.

;; ============================================================================
;; Rounding and Truncation Functions
;; ============================================================================

(define test-abs (lambda ()
  (assert-equal (abs 5) 5)
  (assert-equal (abs -5) 5)
  (assert-equal (abs 0) 0)))

(define test-floor (lambda ()
  (assert-equal (floor 3.7) 3)
  (assert-equal (floor -3.7) -4)
  (assert-equal (floor 5) 5)))

(define test-ceiling (lambda ()
  (assert-equal (ceiling 3.2) 4)
  (assert-equal (ceiling -3.2) -3)
  (assert-equal (ceiling 5) 5)))

(define test-trunc (lambda ()
  (assert-equal (trunc 3.7) 3)
  (assert-equal (trunc -3.7) -3)
  (assert-equal (trunc 5) 5)))

(define test-round (lambda ()
  (assert-equal (round 3.5) 4)
  (assert-equal (round 3.7) 4)))

(define test-round-with-digits (lambda ()
  (assert-equal (round 3.14159 2) 3.14)))

(define test-signum (lambda ()
  (assert-equal (signum 5) 1)
  (assert-equal (signum -5) -1)
  (assert-equal (signum 0) 0)))

;; ============================================================================
;; Power and Roots
;; ============================================================================

(define test-sqrt (lambda ()
  (assert-equal (sqrt 4) 2)
  (assert-equal (sqrt 9) 3)
  (assert-equal (sqrt 1) 1)))

(define test-expt (lambda ()
  (assert-equal (expt 2 10) 1024)
  (assert-equal (expt 3 3) 27)
  (assert-equal (expt 5 0) 1)
  (assert-equal (expt 2 -1) 0.5)))

(define test-exp (lambda ()
  (assert-equal (exp 0) 1)))

;; ============================================================================
;; Logarithmic Functions
;; ============================================================================

(define test-log-exp-inverse (lambda ()
  (define x 10)
  (define result (exp (log x)))
  (assert-true (< (abs (- result x)) 0.001))))

(define test-log10 (lambda ()
  (assert-equal (log10 100) 2)
  (assert-equal (log10 1000) 3)))

(define test-log2 (lambda ()
  (assert-equal (log2 8) 3)
  (assert-equal (log2 1024) 10)))

(define test-log-with-base (lambda ()
  ;; log with optional base argument
  (assert-equal (log 8 2) 3)
  (assert-equal (log 1000 10) 3)))


;; ============================================================================
;; Trigonometric Functions
;; ============================================================================

(define test-trig-basic (lambda ()
  (assert-true (< (abs (sin 0)) 0.001))
  (assert-true (< (abs (- (cos 0) 1)) 0.001))
  (assert-true (< (abs (tan 0)) 0.001))
  (define pi-half (/ 3.141592653589793 2))
  (assert-true (< (abs (- (sin pi-half) 1)) 0.001))))

(define test-trig-inverse (lambda ()
  (assert-true (< (abs (acos 1)) 0.001))
  (assert-true (< (abs (atan 0)) 0.001))
  (define result (asin 1))
  (define pi-half (/ 3.141592653589793 2))
  (assert-true (< (abs (- result pi-half)) 0.001))))

;; ============================================================================
;; Integer Division
;; ============================================================================

(define test-quotient (lambda ()
  (assert-equal (quotient 17 5) 3)
  (assert-equal (quotient -17 5) -3)
  (assert-equal (quotient -17 -5) 3)))

(define test-remainder (lambda ()
  (assert-equal (remainder 17 5) 2)
  (assert-equal (remainder -17 5) -2)))

(define test-modulo-negative-numerator (lambda ()
  (assert-equal (modulo 17 5) 2)
  (assert-equal (modulo -17 5) 3)))

(define test-quotient-remainder-identity (lambda ()
  ;; For any x, y: x = y * quotient(x,y) + remainder(x,y)
  (define x 17)
  (define y 5)
  (assert-equal x (+ (* y (quotient x y)) (remainder x y)))))

;; ============================================================================
;; Number Theory
;; ============================================================================

(define test-gcd (lambda ()
  (assert-equal (gcd 48 18) 6)
  (assert-equal (gcd 100 35) 5)
  (assert-equal (gcd 42) 42)))

(define test-gcd-multiple-args (lambda ()
  (assert-equal (gcd 48 18 12) 6)))

(define test-lcm (lambda ()
  (assert-equal (lcm 12 18) 36)
  (assert-equal (lcm 7 11) 77)
  (assert-equal (lcm 15) 15)))

(define test-lcm-multiple-args (lambda ()
  (assert-equal (lcm 4 6 8) 24)))

(define test-gcd-lcm-identity (lambda ()
  ;; For any a, b: gcd(a,b) * lcm(a,b) = a * b
  (define a 12)
  (define b 18)
  (assert-equal (* (gcd a b) (lcm a b)) (* a b))))
