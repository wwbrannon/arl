;; Native tests for string operations - User-facing examples
;; For comprehensive edge case testing, see tests/testthat/test-stdlib-strings.R
;; These tests demonstrate idiomatic usage patterns with simple examples.

;; ============================================================================
;; Character Access
;; ============================================================================

(define test-char-at-basic (lambda ()
  (assert-equal (char-at "hello" 0) "h")
  (assert-equal (char-at "hello" 4) "o")))

(define test-string-ref-alias (lambda ()
  ;; string-ref is Scheme name for char-at
  (assert-equal (string-ref "world" 1) "o")))

;; ============================================================================
;; Substring
;; ============================================================================

(define test-substring-basic (lambda ()
  (assert-equal (substring "hello world" 0 5) "hello")
  (assert-equal (substring "hello world" 6 11) "world")))

;; ============================================================================
;; Case Conversion
;; ============================================================================

(define test-string-upcase (lambda ()
  (assert-equal (string-upcase "hello") "HELLO")))

(define test-string-downcase (lambda ()
  (assert-equal (string-downcase "HELLO") "hello")))

(define test-string-titlecase (lambda ()
  (assert-equal (string-titlecase "hello world") "Hello World")))

;; ============================================================================
;; String Comparison
;; ============================================================================

(define test-string-comparison (lambda ()
  (assert-true (string<? "abc" "def"))
  (assert-true (string>? "def" "abc"))
  (assert-true (string=? "hello" "hello"))))

;; ============================================================================
;; String Length
;; ============================================================================

(define test-string-length (lambda ()
  (assert-equal (string-length "hello") 5)
  (assert-equal (string-length "") 0)))

;; ============================================================================
;; String/List Conversions
;; ============================================================================

(define test-string-list-conversion (lambda ()
  (assert-equal (string->list "abc") (list "a" "b" "c"))
  (assert-equal (list->string (list "a" "b" "c")) "abc")))

(define test-string-list-roundtrip (lambda ()
  (define str "hello")
  (assert-equal (list->string (string->list str)) str)))

;; ============================================================================
;; Number/String Conversions
;; ============================================================================

(define test-number-to-string (lambda ()
  (assert-equal (number->string 42) "42")
  (assert-equal (number->string -17) "-17")))

(define test-number-to-string-bases (lambda ()
  ;; Hex and binary conversions
  (assert-equal (number->string 255 16) "ff")
  (assert-equal (number->string 10 2) "1010")))

(define test-string-to-number (lambda ()
  (assert-equal (string->number "42") 42)
  (assert-equal (string->number "3.14") 3.14)))

(define test-string-to-number-bases (lambda ()
  ;; Parse from different bases
  (assert-equal (string->number "ff" 16) 255)
  (assert-equal (string->number "1010" 2) 10)))

(define test-string-to-number-invalid (lambda ()
  ;; Invalid number should return #nil or #f
  (assert-false (string->number "not-a-number"))))
