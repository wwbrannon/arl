---
title: "Standard Library: Type Conversions"
output:
  rmarkdown::html_vignette:
    highlight: null
vignette: >
  %\VignetteIndexEntry{Standard Library: Type Conversions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```

These functions are provided by the `conversions` module (`inst/rye/conversions.rye`).

## Symbol Conversions

### symbol->string

Converts a symbol to a string.

**Signature:** `(symbol->string sym)`

**Examples:**
```lisp
(symbol->string 'foo)     ; => "foo"
(symbol->string 'hello)   ; => "hello"
```

**Errors:** Raises error if argument is not a symbol.

**See also:** string->symbol, ->symbol

---

### string->symbol

Converts a string to a symbol.

**Signature:** `(string->symbol str)`

**Examples:**
```lisp
(string->symbol "foo")    ; => 'foo
(string->symbol "hello")  ; => 'hello
```

**Errors:** Raises error if argument is not a string.

**See also:** symbol->string, ->symbol

---

### ->symbol

Coerces any value to a symbol.

**Signature:** `(->symbol x)`

**Examples:**
```lisp
(->symbol 'foo)           ; => 'foo (already a symbol)
(->symbol "hello")        ; => 'hello
(->symbol 42)             ; => '42
```

**See also:** symbol->string, string->symbol

---

## Numeric Conversions

### ->number

Converts a value to a number.

**Signature:** `(->number x)`

**Examples:**
```lisp
(->number 42)             ; => 42 (already a number)
(->number "3.14")         ; => 3.14
(->number "42")           ; => 42
```

**Errors:**
- Raises error if string cannot be parsed as a number
- Raises error if value cannot be converted to number

**See also:** ->integer, ->double, ->complex

---

### ->integer

Converts a value to an integer.

**Signature:** `(->integer x)`

**Examples:**
```lisp
(->integer 5.7)           ; => 5 (truncates toward zero)
(->integer "42")          ; => 42
(->integer 3.14)          ; => 3
```

**Errors:**
- Raises error if string cannot be parsed as integer
- Raises error if value cannot be converted

**Note:** R's `as.integer()` truncates toward zero (like C's `(int)` cast).

**See also:** ->double, ->number, inexact->exact

---

### ->double

Converts a value to a double (floating-point number).

**Signature:** `(->double x)`

**Examples:**
```lisp
(->double 5)              ; => 5.0
(->double "3.14")         ; => 3.14
(->double 42L)            ; => 42.0
```

**Errors:**
- Raises error if string cannot be parsed as double
- Raises error if value cannot be converted

**See also:** ->integer, ->number, exact->inexact

---

### ->complex

Converts a value to a complex number (imaginary part = 0 if not specified).

**Signature:** `(->complex x)`

**Examples:**
```lisp
(->complex 5)             ; => 5+0i
(->complex "3+4i")        ; => 3+4i
(->complex 3.14)          ; => 3.14+0i
```

**Errors:**
- Raises error if string cannot be parsed as complex
- Raises error if value cannot be converted

**See also:** make-rectangular, make-polar (in `math` module)

---

## Scheme-Style Exact/Inexact Conversions

### exact->inexact

Converts an exact number to inexact (integer storage to double storage).

**Signature:** `(exact->inexact x)`

**Examples:**
```lisp
(exact->inexact 5)        ; => 5.0
(exact->inexact 42L)      ; => 42.0
```

**Errors:** Raises error if argument is not a number.

**Note:** In Scheme, exactness is a mathematical property. In R (and Rye), it corresponds to storage type: integers are exact, doubles and complex are inexact.

**See also:** inexact->exact, exact? (in `math` module)

---

### inexact->exact

Converts an inexact number to exact (double storage to integer storage).

**Signature:** `(inexact->exact x)`

**Examples:**
```lisp
(inexact->exact 5.7)      ; => 5 (truncates)
(inexact->exact 3.14)     ; => 3
(inexact->exact 5.0)      ; => 5
```

**Errors:** Raises error if argument is not a number.

**Warning:** This operation may lose precision! Floating-point numbers are truncated toward zero.

**See also:** exact->inexact, inexact? (in `math` module), ->integer

---

## Collection Conversions

### ->list

Converts a value to a list.

**Signature:** `(->list x)`

**Examples:**
```lisp
(->list [1 2 3])          ; => (1 2 3)
(->list (list 1 2))       ; => (1 2) (already a list)
(->list "hello")          ; => ("h" "e" "l" "l" "o")
```

**See also:** ->vector, as.list (R function)

---

### ->vector

Converts a value to an atomic vector (flattens lists).

**Signature:** `(->vector x)`

**Examples:**
```lisp
(->vector (list 1 2 3))   ; => [1 2 3]
(->vector [1 2 3])        ; => [1 2 3] (already a vector)
```

**Errors:** Raises error if value cannot be converted to vector.

**Note:** Lists are flattened using R's `unlist()`. Nested structures become flat vectors.

**See also:** ->list, unlist (R function)

---

## Usage Notes

### Type Coercion Philosophy

Rye provides two styles of type conversion:

1. **Strict conversions** (e.g., `symbol->string`, `string->symbol`):
   - Require specific input types
   - Raise errors on type mismatch
   - Use when type safety is important

2. **Coercive conversions** (e.g., `->symbol`, `->number`):
   - Accept multiple input types
   - Attempt reasonable coercion
   - Use for flexible/forgiving code

### Numeric Type Conversions

```
->number    : string/number → number (any numeric type)
->integer   : any → integer (exact)
->double    : any → double (inexact)
->complex   : any → complex (inexact)

exact->inexact   : integer → double
inexact->exact   : double → integer (truncates!)
```

### Error Handling

Most conversion functions raise errors on failure:

```lisp
(->number "not-a-number")  ; ERROR: Cannot convert 'not-a-number' to number
(symbol->string 42)        ; ERROR: symbol->string: argument must be a symbol
```

Use `try`/`catch` for graceful error handling if needed.

---

## Migration from predicates Module

In previous versions of Rye, type conversion functions were in the `predicates` module. They are now in the dedicated `conversions` module:

```lisp
; Old (before reorganization)
(import predicates)

; New (after reorganization)
(import conversions)
```

The function signatures and behavior remain unchanged.
