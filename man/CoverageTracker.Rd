% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coverage.R
\name{CoverageTracker}
\alias{CoverageTracker}
\title{R6 class for tracking and reporting Arl code execution coverage}
\description{
Tracks which lines of .arl source files actually execute during runtime.
Maintains execution counts per file/line and generates reports.
Supports flexible configuration for tracking custom directories,
test files, and custom comment syntax.
}
\note{
This class is exported for use by advanced tooling (CI scripts,
IDE plugins, etc.) and for testing purposes. Its API should be
considered \strong{internal} and subject to change without notice.
Most users should interact with coverage through the
\link{Engine} methods \code{enable_coverage()}, \code{disable_coverage()},
\code{get_coverage()}, and \code{reset_coverage()} instead.
}
\examples{
\donttest{
# Create a tracker and engine, then evaluate some Arl code
tracker <- CoverageTracker$new()
engine <- Engine$new(coverage_tracker = tracker)
engine$eval(engine$read("(+ 1 2)"))

# Console report shows which stdlib lines were hit
tracker$report_console()

# HTML report written to a temp directory
outfile <- file.path(tempdir(), "arl-coverage", "index.html")
tracker$report_html(output_file = outfile)
}
}
\keyword{internal}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{coverage}}{Environment mapping "file:line" keys to execution counts}

\item{\code{enabled}}{Logical flag to enable/disable tracking}

\item{\code{all_files}}{Character vector of all .arl files being tracked}

\item{\code{code_lines}}{Environment mapping file paths to integer vectors of code line numbers}

\item{\code{coverable_lines}}{Environment mapping file paths to integer vectors of AST-derived coverable line numbers}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-ArlCoverageTracker-new}{\code{CoverageTracker$new()}}
\item \href{#method-ArlCoverageTracker-track}{\code{CoverageTracker$track()}}
\item \href{#method-ArlCoverageTracker-register_coverable}{\code{CoverageTracker$register_coverable()}}
\item \href{#method-ArlCoverageTracker-get_summary}{\code{CoverageTracker$get_summary()}}
\item \href{#method-ArlCoverageTracker-discover_files}{\code{CoverageTracker$discover_files()}}
\item \href{#method-ArlCoverageTracker-reset}{\code{CoverageTracker$reset()}}
\item \href{#method-ArlCoverageTracker-set_enabled}{\code{CoverageTracker$set_enabled()}}
\item \href{#method-ArlCoverageTracker-report_console}{\code{CoverageTracker$report_console()}}
\item \href{#method-ArlCoverageTracker-report_html}{\code{CoverageTracker$report_html()}}
\item \href{#method-ArlCoverageTracker-report_json}{\code{CoverageTracker$report_json()}}
\item \href{#method-ArlCoverageTracker-clone}{\code{CoverageTracker$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-new"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-new}{}}}
\subsection{Method \code{new()}}{
Initialize the coverage tracker
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$new(
  search_paths = NULL,
  include_tests = FALSE,
  path_strip_patterns = NULL,
  output_prefix = "arl",
  report_title = "Arl Code Coverage",
  code_line_pattern = "^\\\\s*[^[:space:];]"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{search_paths}}{Character vector of directories to search for .arl files (NULL = use stdlib)}

\item{\code{include_tests}}{Whether to include test files in coverage tracking (default: FALSE)}

\item{\code{path_strip_patterns}}{Custom regex patterns for stripping paths in reports (NULL = use defaults)}

\item{\code{output_prefix}}{Subdirectory name for report outputs (default: "arl")}

\item{\code{report_title}}{Title to use in coverage reports (default: "Arl Code Coverage")}

\item{\code{code_line_pattern}}{Regex pattern to identify code lines vs comments/blanks}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-track"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-track}{}}}
\subsection{Method \code{track()}}{
Track execution of an expression with source info
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$track(arl_src)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{arl_src}}{Source information object with file, start_line, end_line}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-register_coverable"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-register_coverable}{}}}
\subsection{Method \code{register_coverable()}}{
Register coverable lines from an instrumented source range
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$register_coverable(file, start_line, end_line)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{file}}{Source file path}

\item{\code{start_line}}{Start line of the instrumented form}

\item{\code{end_line}}{End line of the instrumented form}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-get_summary"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-get_summary}{}}}
\subsection{Method \code{get_summary()}}{
Get coverage summary as list: file -> line -> count
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$get_summary()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-discover_files"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-discover_files}{}}}
\subsection{Method \code{discover_files()}}{
Discover all .arl files to track

Searches for .arl files in configured search paths or stdlib by default.
By default excludes test files unless include_tests = TRUE.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$discover_files()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-reset"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-reset}{}}}
\subsection{Method \code{reset()}}{
Reset coverage data
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$reset()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-set_enabled"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-set_enabled}{}}}
\subsection{Method \code{set_enabled()}}{
Enable/disable tracking
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$set_enabled(enabled)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{enabled}}{Logical value to enable (TRUE) or disable (FALSE) coverage tracking}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-report_console"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-report_console}{}}}
\subsection{Method \code{report_console()}}{
Generate console coverage report
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$report_console(output_file = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{output_file}}{Optional file to write report to (default: console only)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-report_html"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-report_html}{}}}
\subsection{Method \code{report_html()}}{
Generate HTML coverage report
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$report_html(output_file = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{output_file}}{Path to output HTML file (NULL = use default based on output_prefix)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-report_json"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-report_json}{}}}
\subsection{Method \code{report_json()}}{
Generate codecov-compatible JSON format
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$report_json(output_file = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{output_file}}{Path to output JSON file (NULL = use default based on output_prefix)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ArlCoverageTracker-clone"></a>}}
\if{latex}{\out{\hypertarget{method-ArlCoverageTracker-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{CoverageTracker$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
